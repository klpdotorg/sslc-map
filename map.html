<!DOCTYPE html>
<html>
<head>
	  <meta charset='utf-8'/>
 <!--[if lte IE 8]>
     <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4/leaflet.ie.css" />
 <![endif]-->
  <script src='wax/ext/leaflet.js' type='text/javascript'></script>
  <script src='wax/dist/wax.leaf.js' type='text/javascript'></script>
  <link href='wax/ext/leaflet.css' rel='stylesheet' type='text/css' />  
  <link href='wax/theme/controls.css' rel='stylesheet' type='text/css' />

  
<script src="sslc.js" type="text/javascript"></script>
</head>
<div id="map" style="height:650px"></div>

<div class="wax-legend">  
<div class="legend-title">Karnataka SSLC Results 2012</div>  
<div class="legend-scale">  
  <ul class="legend-labels">  
    <li><span style="background:#6b2403;"></span>>80%</li>  
    <li><span style="background:#fa702e;"></span></li>  
    <li><span style="background:#f9590d;"></span></li>  
    <li><span style="background:#fcb492;"></span>>70%</li>  
   <li><span style="background:#fed6c3;"></span></li>   
   <li><span style="background:#fff;"></span>>50%</li>  
  </ul>  
</div>
<div class="legend-source"><a href="http://klp.org.in">Karnataka Learning Partnership</a></div> 
</div>
</div>

<script>

var cloudmadeUrl = 'http://tile.stamen.com/toner/{z}/{x}/{y}.png',
        cloudmadeAttrib = '<a href="http://maps.stamen.com" target="_blank">Stamen</a>, <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a> and contributors, <a href="http://klp.org.in" target="_blank">Karnataka Learning Partnership</a>';
var cloudmade = new L.TileLayer(cloudmadeUrl, {maxZoom: 18, attribution: cloudmadeAttrib});
var tilejson = {
  tilejson: '1.0.0',
  scheme: 'xyz',
  tiles: ['http://tiles.klp.org.in/maps/sslc/{z}/{x}/{y}.png'],
  grids: ['http://tiles.klp.org.in/maps/sslc/{z}/{x}/{y}.grid.json'],
  formatter: function(options, data) { console.log(data);

url = "http://chart.googleapis.com/chart?chf=a,s,000000B4|bg,s,000000&chxl=0:|Rank+1|Rank+34&chxp=0,1,34&chxr=0,0,34&chxt=y&chs=290x225&cht=gm&chco=FFD597,FFB951,FFA41C,8C8C8C|383838|E40000&chds=0,34,0,34,0,34&chd=t:"+data['dp_2010']+"|"+data['dp_2011']+"|"+data['dp_2012']+"&chdlp=l&chl=2010|2011|2012&chtt=District+Rank&chts=858585,11.5"

return "<b class= 'district'>"+data['DISTSHP']+" "+Math.round(data['p_2012'])+"%</b><hr><img src="+url+">"; }
};
  var map = new L.Map('map')
    .addLayer(cloudmade)
    .addLayer(new wax.leaf.connector(tilejson))
    .setView(new L.LatLng(13, 77), 7);
  wax.leaf.interaction()
    .map(map)
    .tilejson(tilejson)
    .on(wax.tooltip().animate(true).parent(map._container).events());
</script>
</body>
</html>